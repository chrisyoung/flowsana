module Repository
  module Memory
    class <%= repository_name.camelize %>
      attr_accessor :listener

      def initialize
        @list = []
      end

      def find(<%= repository_name %>)
        @list.first do |listed_<%= repository_name %>|
          <%= repository_name %> == listed_<%= repository_name %>
        end
      end

      def all
        @listener.<%= repository_name %>_repository_all_success(@list)
      end

      def create(attributes)
        ::<%= repository_name.camelize %>.new(attributes).tap do |<%= repository_name %>|
          if <%= repository_name %>.valid?
            @list << <%= repository_name %>
            @listener.<%= repository_name %>_repository_create_success(<%= repository_name %>) if @listener
          else
            @listener.<%= repository_name %>_repository_create_failure if @listener
          end
        end
      end

      def count
        @list.count
      end

      def first
        @list.first
      end
    end
  end
end

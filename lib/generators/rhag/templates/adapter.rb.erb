module Repository::Adapters::AR
  class <%= repository_name.camelize %>
    def initialize(listener)
      @listener = listener
      @data     = Repository::Adapters::AR::Data::<%= repository_name.camelize %>
    end

    def get id
      @listener.<%= repository_name %>_adapter_get_success(
        ::<%= repository_name.camelize %>.new(@data.find(id)))
    end

    def create(attributes)
      @listener.<%= repository_name %>_adapter_create_success(
        ::<%= repository_name.camelize %>.new(@data.create(attributes).attributes))
    end

    def list
      @listener.<% repository_name %>_adapter_create_success(
        ::<%= repository_name.camelize %>_adapter_create_success(@data.all))
    end

    def all
      @listener.<%= repository_name %>_adapter_all_success(
        @data.all.map {|<%= repository_name %>| ::<%= repository_name.camelize %>.new(<%= repository_name %>.attributes)})
    end
  end
end
